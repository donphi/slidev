services:
  # Sli.dev Presentation Engine
  slidev:
    build: ./presentation
    ports:
      - "3030:3030"
    volumes:
      - ./presentation:/app
      - /app/node_modules
    restart: unless-stopped
    environment:
      - CHOKIDAR_USEPOLLING=true
    networks:
      - slidev-network

  # Editor Service (Backend + Frontend)
  editor:
    build: ./editor
    ports:
      - "3001:3000"
    volumes:
      # Mount presentation folder so editor can read/write slides.md
      - ./presentation:/app/presentation:rw
    environment:
      - PORT=3000
      - SLIDES_PATH=/app/presentation/slides.md
      - SLIDEV_URL=http://localhost:3030
      # Set a password to protect the editor (leave empty for no auth)
      - EDITOR_PASSWORD=${EDITOR_PASSWORD:-}
      # Number of backup versions to keep (default: 10)
      - MAX_HISTORY=${MAX_HISTORY:-10}
    depends_on:
      - slidev
    restart: unless-stopped
    networks:
      - slidev-network

networks:
  slidev-network:
    driver: bridge
