# Local development - uses the same combined approach as Railway
# Run: docker-compose up --build

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile.railway
    ports:
      - "3000:3000"
    volumes:
      # Mount user-editable files for persistence during development
      - ./presentation/slides.md:/app/userdata/slides.md
      - ./presentation/style.css:/app/userdata/style.css
    environment:
      - PORT=3000
      - SLIDES_PATH=/app/userdata/slides.md
      - STYLE_PATH=/app/userdata/style.css
      - SLIDEV_DIR=/app/presentation
      - SLIDEV_URL=http://localhost:3030
      # Set a password to protect the editor (leave empty for no auth)
      - EDITOR_PASSWORD=${EDITOR_PASSWORD:-}
      # Number of backup versions to keep (default: 10)
      - MAX_HISTORY=${MAX_HISTORY:-10}
      # Database URL for persistent storage (optional)
      - DATABASE_URL=${DATABASE_URL:-}
    restart: unless-stopped
